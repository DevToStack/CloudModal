<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>College Admin Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2><i class="fas fa-graduation-cap"></i> College Admin</h2>
      </div>
      <nav class="sidebar-nav">
        <a href="#" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
        <a href="#"><i class="fas fa-user-graduate"></i> Students</a>
        <a href="#"><i class="fas fa-chalkboard-teacher"></i> Teachers</a>
        <a href="#"><i class="fas fa-book"></i> Courses</a>
        <a href="#"><i class="fas fa-money-bill-wave"></i> Fees</a>
        <a href="#"><i class="fas fa-file-alt"></i> Exams</a>
        <a href="#"><i class="fas fa-chart-bar"></i> Reports</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <div class="header">
        <button class="mobile-menu-btn" id="menuToggle">
          <i class="fas fa-bars"></i>
        </button>
        <h1>Dashboard</h1>
        <div class="user-profile">
          <i class="fas fa-user-circle fa-2x"></i>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Students</h3>
          <p id="total-students">1,025</p>
        </div>
        <div class="stat-card">
          <h3>Total Teachers</h3>
          <p id="total-teachers">58</p>
        </div>
        <div class="stat-card">
          <h3>Active Courses</h3>
          <p id="total-courses">32</p>
        </div>
        <div class="stat-card fees">
          <h3>Fees Collected</h3>
          <p id="total-fees">₹42.6L</p>
        </div>
      </div>

      <!-- Program Overview -->
      <div class="card">
        <h2>Program Overview</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Program</th>
              <th>Year</th>
              <th>Sections</th>
              <th>Students</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>BTech (CSE)</td>
              <td>1st</td>
              <td>A, B</td>
              <td>210</td>
            </tr>
            <tr>
              <td>MBA</td>
              <td>2nd</td>
              <td>A</td>
              <td>90</td>
            </tr>
            <tr>
              <td>BCom</td>
              <td>3rd</td>
              <td>A, B, C</td>
              <td>150</td>
            </tr>
            <tr>
              <td>MSc (IT)</td>
              <td>1st</td>
              <td>A</td>
              <td>45</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Fee Summary and Payments -->
      <div class="summary-grid">
        <div class="card">
          <h2>Fee Status</h2>
          <ul class="class-list">
            <li><strong>Paid:</strong> 680 Students</li>
            <li><strong>Partial:</strong> 210 Students</li>
            <li><strong>Unpaid:</strong> 135 Students</li>
          </ul>
        </div>
        <div class="card">
          <h2>Recent Payments</h2>
          <ul class="class-list">
            <li>Ananya Singh - ₹12,000 - UPI</li>
            <li>Rahul Desai - ₹8,000 - Card</li>
            <li>Priya Patel - ₹15,000 - Net Banking</li>
            <li>Vikram Sharma - ₹10,000 - UPI</li>
          </ul>
        </div>
      </div>

      <!-- Upcoming Exams -->
      <div class="card">
        <h2>Upcoming Exams</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Course</th>
              <th>Class</th>
              <th>Exam</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Data Structures</td>
              <td>CSE - 2B</td>
              <td>Mid Sem</td>
              <td>2025-06-10</td>
            </tr>
            <tr>
              <td>Financial Accounting</td>
              <td>BCom - 3A</td>
              <td>Unit Test</td>
              <td>2025-06-12</td>
            </tr>
            <tr>
              <td>Operating Systems</td>
              <td>IT - 2C</td>
              <td>Practical</td>
              <td>2025-06-15</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Today's Classes -->
      <div class="card">
        <h2>Today's Classes</h2>
        <ul class="class-list">
          <li><i class="fas fa-clock"></i> 10:00 - 11:00: DBMS (Room 201)</li>
          <li><i class="fas fa-clock"></i> 11:00 - 12:00: Mathematics (Room 205)</li>
          <li><i class="fas fa-clock"></i> 2:00 - 3:00: Operating Systems (Room 210)</li>
          <li><i class="fas fa-clock"></i> 3:00 - 4:00: Business Ethics (Room 305)</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // Toggle sidebar on mobile
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    
    menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('open');
    });
    
    // Close sidebar when clicking outside
    document.addEventListener('click', (e) => {
      const isClickInsideSidebar = sidebar.contains(e.target);
      const isClickOnMenuButton = menuToggle.contains(e.target);
      
      if (!isClickInsideSidebar && !isClickOnMenuButton && sidebar.classList.contains('open')) {
        sidebar.classList.remove('open');
      }
    });

    const BASE_URL='http://localhost:3000/api/admin';

    async function fetchData(endpoint,method='GET',data=null) {

      //headders
      const config={
        method,
        headers:{
          'Content-Type':'application/json',
        }
      }

      if(data){
        config.body = JSON.stringify(data);
      }

      try{
        const response = await fetch(BASE_URL+endpoint,config);
        const result = await response.json();
        if(!response.ok){
          throw new Error(result.message || 'Request failed');
        }
        return result;
      }catch(error){
          console.error('API Error:',error.message);
          return null;
      }
    }

    async function loadDashboardStats() {
      try {
          const stats = await fetchData('/dashboard/stats'); // Await the promise

          document.getElementById('total-students').textContent=stats.total_students;
          document.getElementById('total-teachers').textContent=stats.total_teachers;
          document.getElementById('total-courses').textContent=stats.total_courses;
          document.getElementById('total-fees').textContent='₹'+stats.total_fees;
          
      } catch (error) {
          console.error('Failed to load dashboard stats:', error);
      }
    }

    function init(){
      loadDashboardStats();
    }

    document.addEventListener('DOMContent Loaded',init());
  </script>
</body>
</html>